(window.webpackJsonpremote=window.webpackJsonpremote||[]).push([[0],{0:function(e,t){e.exports=PropTypes},1:function(e,t){e.exports=React},132:function(e,t){e.exports=ObjectAssign},143:function(e,t,a){},144:function(e,t,a){},145:function(e,t,a){},146:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(7),o=a.n(c),u=(a(81),a(20)),i=a(10),s=a.n(i),l=a(21),m=a(8),f=a(73),p=a.n(f);a(83),a(84);function d(e){var t=e.children,a=e.className;return n.createElement("div",{className:"Toggle ".concat(a||"")},t)}d.Button=function(e){var t=e.id,a=e.value,r=e.children,c=e.onChange,o=e.checked;return n.createElement(n.Fragment,null,n.createElement("input",{type:"radio",value:a,checked:o||!1,onChange:function(e){e.target.checked&&c(a)},id:t,className:"Toggle-Option-Radio"}),n.createElement("label",{htmlFor:t,className:"Toggle-Option"},r))};var h=function(e){var t=e.children;return r.a.createElement("div",{className:"Tabs-Panel"},t)},b=function(e){var t=e.children,a=e.className,c=Object(n.useState)(0),o=Object(m.a)(c,2),u=o[0],i=o[1],s=t[u];return t?r.a.createElement("div",{className:"Tabs "+(a||"")},r.a.createElement("div",{className:"Tabs-Navigation"},r.a.createElement(d,null,t.map((function(e,t){return r.a.createElement(d.Button,{id:""+t,key:t,value:t,onChange:i,checked:u===t},e.props.label)})))),r.a.createElement(h,s.props)):null},v=b;b.Tab=h;a(85),a(86);var O=function(e){var t=e.label,a=e.value,n=e.unit;return r.a.createElement("div",{className:"Indicator"},r.a.createElement("span",{className:"Label"},t),r.a.createElement("span",{className:"Value"},r.a.createElement("span",null,a),r.a.createElement("span",{className:"Unit"},n)))},E=(a(87),a(79)),y=(a(142),function(e){var t=e.onPowerChange,a=e.onModeChange,c=e.onFanSpeedChange,o=e.onTemperatureChange,u=e.state,i=u.power,s=u.mode,l=u.fan_speed,f=u.temperature,p="heater"===s?20:22,h=Object(n.useState)(f),b=Object(m.a)(h,2),v=b[0],O=b[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{className:"Option-row"},r.a.createElement(d.Button,{id:"pwr-on",value:!0,checked:i,onChange:t},"On"),r.a.createElement(d.Button,{id:"pwr-off",value:!1,checked:!i,onChange:t},"Off")),r.a.createElement(d,{className:"Option-row"},r.a.createElement(d.Button,{id:"mode-auto",value:"auto",checked:"auto"===s,onChange:a},"Auto"),r.a.createElement(d.Button,{id:"mode-cooler",value:"cooler",checked:"cooler"===s,onChange:a},r.a.createElement("i",{className:"far fa-snowflake"})),r.a.createElement(d.Button,{id:"mode-heater",value:"heater",checked:"heater"===s,onChange:a},r.a.createElement("i",{className:"fas fa-sun"})),r.a.createElement(d.Button,{id:"mode-dry",value:"dry",checked:"dry"===s,onChange:a},"Dry"),r.a.createElement(d.Button,{id:"mode-fan",value:"fan",checked:"fan"===s,onChange:a},r.a.createElement("i",{className:"fas fa-fan small"}))),r.a.createElement(d,{className:"Option-row"},r.a.createElement(d.Button,{id:"speed-auto",value:"auto",checked:"auto"===l,onChange:c},"Auto"),r.a.createElement(d.Button,{id:"speed-high",value:"high",checked:"high"===l,onChange:c},r.a.createElement("i",{className:"fas fa-fan"})),r.a.createElement(d.Button,{id:"speed-low",value:"low",checked:"low"===l,onChange:c},r.a.createElement("i",{className:"fas fa-fan small"})),r.a.createElement(d.Button,{id:"speed-quiet",value:"quiet",checked:"quiet"===l,onChange:c},r.a.createElement("i",{className:"fas fa-volume-mute"})),r.a.createElement(d.Button,{id:"speed-natural",value:"natural",checked:"natural"===l,onChange:c},r.a.createElement("i",{className:"fas fa-tree"}))),r.a.createElement("div",{className:"Option-row Option-row_slider"},r.a.createElement(E.a,{min:p,max:30,value:v,onChange:O,onAfterChange:o,trackStyle:{backgroundColor:"transparent",height:6},railStyle:{backgroundColor:"#106d82",height:6},handleStyle:{border:"1px solid #106d82",height:20,width:20,marginLeft:0,marginTop:-7,backgroundColor:"white"}}),r.a.createElement("div",{className:"Target-temperature"},v,"\xb0C")))}),g=a(77),j=a(78);function w(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?w(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):w(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k=function(){function e(){Object(g.a)(this,e),this.url_base="/api/"}return Object(j.a)(e,[{key:"_fetch",value:function(e,t,a,n){var r=this.url_base+a,c={method:e,headers:N({Accept:"application/json"},t)};return n&&(c.body=JSON.stringify(n)),fetch(r,c)}},{key:"_delete",value:function(e){return this._fetch("DELETE",{},e)}},{key:"_put",value:function(e,t){return this._fetch("PUT",{"Content-Type":"application/json;charset=UTF-8"},e,t)}},{key:"_post",value:function(e,t){return this._fetch("POST",{"Content-Type":"application/json;charset=UTF-8"},e,t)}},{key:"off",value:function(){this._post("off")}},{key:"on",value:function(){this._post("on")}},{key:"mode",value:function(e){this._post("mode",{mode:e})}},{key:"fan",value:function(e){this._post("fan",{speed:e})}},{key:"temperature",value:function(e){this._post("temperature",{temperature:e})}},{key:"history",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url_base+"sensor");case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sensor",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url_base+"sensor");case 2:return t=e.sent,e.next=5,t.json();case 5:if(0!==(a=e.sent).length){e.next=8;break}return e.abrupt("return",null);case 8:return e.abrupt("return",a[0]);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"state",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url_base+"state");case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"timers",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.url_base+"timers");case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"add_timer",value:function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._post("timers",t);case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove_timer",value:function(e){return this._delete("timers/"+e)}},{key:"set_timer",value:function(e,t){return this._put("timers/"+e,t)}}]),e}(),C={mode:"auto",power:!1,fan_speed:"auto",temperature:25},x=(a(143),function(e){var t=e.children,a=Object(n.useState)(!1),c=Object(m.a)(a,2),o=c[0],u=c[1];return r.a.createElement("div",{className:"Drawer"},r.a.createElement("div",{className:"Drawer-Content "+(o?"Open":"")},t),r.a.createElement("button",{className:"Drawer-Button",onClick:function(){return u(!o)}},o?r.a.createElement("i",{className:"fa fa-chevron-up"}):r.a.createElement("i",{className:"fa fa-chevron-down"})))}),P=a(15),_=(a(144),a(58)),T=a(41),D=a(42),S=a(57),A=function(e){var t=e.history,a=Object(n.useRef)(null),c=Object(n.useState)(86400),o=Object(m.a)(c,2),u=o[0],i=o[1];return Object(n.useEffect)((function(){var e=(new Date).getTime()/1e3-u,n=t.filter((function(t){return t.timestamp>=e})).sort((function(e,t){return e.timestamp-t.timestamp})),r=Math.min.apply(Math,Object(P.a)(n.map((function(e){return e.temperature}))))-2,c=Math.max.apply(Math,Object(P.a)(n.map((function(e){return e.temperature}))))+2,o=Math.min.apply(Math,Object(P.a)(n.map((function(e){return e.humidity}))))-5,i=Math.max.apply(Math,Object(P.a)(n.map((function(e){return e.humidity}))))+5,s=Math.min.apply(Math,Object(P.a)(n.map((function(e){return e.timestamp})))),l=Math.max.apply(Math,Object(P.a)(n.map((function(e){return e.timestamp})))),m=20,f=100,p=100,d=100,h=600-d-f,b=400-m-p;Object(_.a)(a.current).select("*").remove();var v=Object(_.a)(a.current).attr("viewBox","0 0 ".concat(h+d+f," ").concat(b+m+p)).append("g").attr("transform","translate(".concat(d,",").concat(m,")")),O=Object(T.a)().domain([o,i]).range([b,0]),E=Object(T.a)().domain([r,c]).range([b,0]),y=Object(T.b)().domain([new Date(1e3*s),new Date(1e3*l)]).range([0,h]);v.append("g").attr("transform","translate(0,".concat(b,")")).attr("class","axis").style("text-anchor","end").call(Object(D.a)(y)).selectAll("text").attr("transform","translate(-10,10)rotate(-45)"),v.append("g").attr("class","axis").call(Object(D.b)(E).ticks(7)),v.append("g").attr("class","axis").attr("transform","translate(".concat(h,",0)")).call(Object(D.c)(O).ticks(5));var g=Object(S.a)().x((function(e){return y(new Date(1e3*e.timestamp))})).y((function(e){return E(e.temperature)}));v.append("path").datum(n).attr("class","Chart_ts-1").attr("d",g);var j=Object(S.a)().x((function(e){return y(new Date(1e3*e.timestamp))})).y((function(e){return O(e.humidity)}));v.append("path").datum(n).attr("class","Chart_ts-2").attr("d",j),v.append("text").attr("text-anchor","middle").attr("transform","rotate(-90)").attr("font-size","30px").attr("y",40-d).attr("x",-b/2).attr("fill","red").text("Temperature"),v.append("text").attr("text-anchor","middle").attr("transform","rotate(90)").attr("font-size","30px").attr("y",-h-f+40).attr("x",b/2).attr("fill","steelblue").text("Humidity")}),[t,u]),r.a.createElement(r.a.Fragment,null,r.a.createElement("svg",{className:"Chart",ref:a}),r.a.createElement("div",{className:"Chart"},r.a.createElement("button",{onClick:function(){return i(21600)}},"6h"),r.a.createElement("button",{onClick:function(){return i(86400)}},"1d"),r.a.createElement("button",{onClick:function(){return i(172800)}},"2d"),r.a.createElement("button",{onClick:function(){return i(604800)}},"1w")))};function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var F=function(e,t){switch(t.type){case"loading":return{state:"loading",timers:[]};case"reset":return{state:"loaded",timers:t.payload};case"add":return{state:e.state,timers:[].concat(Object(P.a)(e.timers),[t.payload])};case"remove":return{state:e.state,timers:e.timers.filter((function(e){return e.tid!==t.payload.tid}))};case"update":return{state:e.state,timers:e.timers.map((function(e){return e.tid===t.payload.tid?t.payload:e}))}}return e},I={state:"initial",timers:[]};a(145);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q=function(e){switch(e.mode){case"heater":return r.a.createElement("i",{className:"far fa-sun"});case"cooler":return r.a.createElement("i",{className:"far fa-snowflake"});case"fan":return r.a.createElement("i",{className:"fas fa-fan small"});case"dry":return r.a.createElement("i",{className:"timer-icon"},"D");default:return r.a.createElement("i",{className:"timer-icon"},"A")}},U=function(e){switch(e.fan){case"low":return r.a.createElement("i",{className:"fas fa-fan small"});case"high":return r.a.createElement("i",{className:"fas fa-fan"});case"quiet":return r.a.createElement("i",{className:"fas fa-volume-mute"});case"natural":return r.a.createElement("i",{className:"fas fa-tree"});default:return r.a.createElement("i",{className:"timer-icon"},"A")}},J=function(e){var t=e.command;return"off"===t.on_off?r.a.createElement("i",{className:"fas fa-toggle-off"}):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"Temperature"},t.temperature,"\u2103"),r.a.createElement("span",{className:"Icon"},r.a.createElement("i",{className:"fas fa-toggle-on"})),r.a.createElement("span",{className:"Icon"},r.a.createElement(q,{mode:t.mode})),r.a.createElement("span",{className:"Icon"},r.a.createElement(U,{fan:t.fan})))},z={enabled:!0,time:"01:00",command:{on_off:"off",temperature:22,fan:"auto",mode:"auto"}};var H=function(e){var t=e.value,a=e.onSave,c=e.onCancel,o=e.onDelete,u=Object(n.useState)(t),i=Object(m.a)(u,2),s=i[0],l=i[1],f=Object(n.useState)(function(e){var t=e.split(":").map(Number);if(2!==t.length)return[8,30];var a=Object(m.a)(t,2);return[a[0],a[1]]}(t.time)),p=Object(m.a)(f,2),d=Object(m.a)(p[0],2),h=d[0],b=d[1],v=p[1],O=function(e){var t=R({},s,{command:e});l(t)};return r.a.createElement("div",{className:"TimerEditor"},r.a.createElement("div",{className:"TimeInput"},r.a.createElement("input",{type:"text",placeholder:"06",value:""+h,onChange:function(e){var t=[Number(e.target.value),b];v(t),l(R({},s,{time:t.join(":")}))}}),"\xa0:\xa0",r.a.createElement("input",{type:"text",value:""+b,placeholder:"30",onChange:function(e){var t=[h,Number(e.target.value)];v(t),l(R({},s,{time:t.join(":")}))}})),r.a.createElement(y,{state:{power:"on"===s.command.on_off,fan_speed:s.command.fan,mode:s.command.mode,temperature:s.command.temperature},onPowerChange:function(e){return O(R({},s.command,{on_off:e?"on":"off"}))},onFanSpeedChange:function(e){return O(R({},s.command,{fan:e}))},onModeChange:function(e){return O(R({},s.command,{mode:e}))},onTemperatureChange:function(e){return O(R({},s.command,{temperature:e}))}}),r.a.createElement("div",{className:"Timers-Action"},r.a.createElement("button",{onClick:function(){return a(s)}},"Save"),o&&r.a.createElement("button",{onClick:function(){return o()}},"Delete"),r.a.createElement("button",{onClick:function(){return c()}},"Close")))},V=function(e){var t=e.client,a=e.dispatch,c=e.timers,o=Object(n.useState)({view:"list"}),u=Object(m.a)(o,2),i=u[0],s=u[1];return"new"===i.view?r.a.createElement(H,{value:z,onSave:function(e){a(function(e,t){return function(a){e.add_timer(t).then((function(e){return a({type:"add",payload:e})}))}}(t,e)),s({view:"list"})},onCancel:function(){return s({view:"list"})}}):"edit"===i.view?r.a.createElement(H,{value:i.timer,onSave:function(e){a(function(e,t,a){return function(n){e.set_timer(a,t).then((function(){return n({type:"update",payload:M({},t,{tid:a})})}))}}(t,e,i.timer.tid)),s({view:"list"})},onCancel:function(){return s({view:"list"})},onDelete:function(){a(function(e,t){return function(a){e.remove_timer(t).then((function(){return a({type:"remove",payload:{tid:t}})}))}}(t,i.timer.tid)),s({view:"list"})}}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Timers-Action"},r.a.createElement("button",{className:"Timers-Action",onClick:function(){return s({view:"new"})}},"Add a timer")),r.a.createElement("ul",{className:"Timers"},c.map((function(e){return r.a.createElement("li",{key:e.tid},r.a.createElement("button",{className:"edit",onClick:function(t){s({view:"edit",timer:e})}},r.a.createElement("span",{className:"Timers-Time"},e.time),r.a.createElement("span",{className:"Timers-Command"},r.a.createElement(J,{command:e.command}))))}))))};function G(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function K(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?G(a,!0).forEach((function(t){Object(u.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):G(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q=new k,W=function(){var e=Object(n.useState)(C),t=Object(m.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)(!0),u=Object(m.a)(o,2),i=u[0],f=u[1],d=Object(n.useState)(null),h=Object(m.a)(d,2),b=h[0],E=h[1],g=Object(n.useState)([]),j=Object(m.a)(g,2),w=j[0],N=j[1],k=p()(F,I),P=Object(m.a)(k,2),_=P[0],T=P[1];return Object(n.useEffect)((function(){function e(){return(e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.history();case 2:t=e.sent,N(t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),Object(n.useEffect)((function(){var e;T((e=Q,function(t){t({type:"loading"}),e.timers().then((function(e){return t({type:"reset",payload:e})}))}))}),[T]),Object(n.useEffect)((function(){Q.state().then((function(e){c(e),Q.sensor().then((function(e){E(e)})),f(!1)}))}),[]),i?r.a.createElement("div",null,"Please wait"):r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement("div",{className:"Indicators"},r.a.createElement(O,{label:"Temperature",value:b?b.temperature:"N/A",unit:"\xb0C"}),r.a.createElement(O,{label:"Humidity",value:b?b.humidity:"N/A",unit:"%"}))),r.a.createElement("main",{className:"App-main"},r.a.createElement(x,null,0===w.length?"Collecting data...":r.a.createElement(A,{history:w})),r.a.createElement(v,{className:"side-tabs"},r.a.createElement(v.Tab,{label:r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"fas fa-broadcast-tower"}))},r.a.createElement("h1",null,"Remote"),r.a.createElement(y,{onPowerChange:function(e){e?Q.on():Q.off(),c((function(t){return K({},t,{power:e})}))},onModeChange:function(e){Q.mode(e),c((function(t){return K({},t,{mode:e})}))},onFanSpeedChange:function(e){Q.fan(e),c((function(t){return K({},t,{fan_speed:e})}))},onTemperatureChange:function(e){Q.temperature(e),c((function(t){return K({},t,{temperature:e})}))},state:a})),r.a.createElement(v.Tab,{label:r.a.createElement(r.a.Fragment,null,r.a.createElement("i",{className:"far fa-clock"}))},r.a.createElement("h1",null,"Timers"),"loaded"===_.state?r.a.createElement(V,{client:Q,dispatch:T,timers:_.timers}):"Loading..."))))};o.a.render(r.a.createElement(W,null),document.getElementById("root"))},39:function(e,t){e.exports=reactLifecyclesCompat},7:function(e,t){e.exports=ReactDOM},80:function(e,t,a){e.exports=a(146)},81:function(e,t,a){},83:function(e,t,a){},84:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},87:function(e,t,a){}},[[80,1,2]]]);
//# sourceMappingURL=main.2e62ed4b.chunk.js.map